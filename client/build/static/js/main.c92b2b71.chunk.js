(this["webpackJsonpmovie-app"]=this["webpackJsonpmovie-app"]||[]).push([[0],{19:function(e,t,n){},34:function(e,t,n){e.exports=n(60)},60:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(30),c=n.n(o),l=(n(19),n(5)),i=n(2),u=n(7),s=n(6),m=n(12),f=n(3),d=n(1),b=n(31),h=n.n(b),p=function(){Object(d.setState)("cookie",!1),Object(d.setState)("currentUser",null),Object(d.setState)("loginForm",{name:"",password:""}),Object(d.setState)("registerForm",{name:"",password:""}),Object(d.setState)("addMovieForm",{name:"",locations:'"Location"',location:"",bluray:!1,dvd:!1}),Object(d.setState)("selectedFile",null),Object(d.setState)("floor",!1),Object(d.setState)("locationList",[]),Object(d.setState)("movieList",[]),Object(d.setState)("source",""),Object(d.setState)("planLoad",!1)},v=function(e){var t=e.className,n=e.name,a=e.value;Object(d.setState)("".concat(t,".").concat(n),a)},E=function(e){var t=e.className,n=e.name,a=e.checked;Object(d.setState)("".concat(t,".").concat(n),a)},j=function(){fetch("/auth/logout").then((function(e){p(),Object(d.setState)("cookie",!0)})).catch((function(e){alert(e)}))},g=function(){console.log("get locations");fetch("/locations").then((function(e){return 200===e.status?e.json():Promise.reject("server error")})).then((function(e){Object(d.setState)("locationList",e)})).catch((function(e){alert(e)}))},O=function(e){Object(d.setState)("selectedFile",e.target.files[0])},y=function(){console.log("fetch upload file"),h.a.get("/uploads/".concat(Object(d.getState)("currentUser"),"/floor_plan.jpg"),{responseType:"arraybuffer"}).then((function(e){var t=btoa(new Uint8Array(e.data).reduce((function(e,t){return e+String.fromCharCode(t)}),""));Object(d.setState)("source","data:;base64,"+t),Object(d.setState)("planLoad",!0)}))},S=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.user;return r.a.createElement("nav",null,r.a.createElement("h1",null,"Flask Movie API"),e?r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("span",null,e)," "),r.a.createElement("li",null,r.a.createElement(m.b,{to:"/"}," Home ")," "),r.a.createElement("li",null,r.a.createElement(m.b,{to:"/floor"}," Floor Plan ")," "),r.a.createElement("li",null,r.a.createElement("button",{className:"logout",onClick:j}," Log Out ")," ")):r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(m.b,{to:"/register"}," Register ")," "),r.a.createElement("li",null,r.a.createElement(m.b,{to:"/login"}," Log In ")," ")))}}]),n}(r.a.Component),N=n(62),k=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentWillMount",value:function(){var e=this;this._subscription=Object(d.subscribe)((function(t){e.setState(t)}),this.filterState.bind(this));var t=this.filterState(Object(d.getState)());if(!Object(N.a)(t))throw new Error("The result of filterState() must be an object");this.setState(t)}},{key:"componentWillUnmount",value:function(){Object(d.unsubscribe)(this._subscription)}},{key:"filterState",value:function(){throw new Error("filterState() is not implemented")}}]),n}(r.a.Component),w=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var a;return Object(l.a)(this,n),a=t.call(this,e),g(),a}return Object(i.a)(n,[{key:"filterState",value:function(e){return{locationList:e.locationList,addMovieForm:e.addMovieForm}}}]),Object(i.a)(n,[{key:"render",value:function(){var e=this.props.user,t=this.state,n=t.locationList,a=t.addMovieForm;return r.a.createElement("div",null,r.a.createElement(S,{user:e}),r.a.createElement("section",{className:"content"},r.a.createElement("header",null,r.a.createElement("h1",null,"New Movie")),r.a.createElement("form",{onSubmit:function(e){return function(e){e.preventDefault(),console.log("add movie");var t=new Request("/addMovie",{method:"post",body:JSON.stringify(Object(d.getState)("addMovieForm")),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});fetch(t).then((function(e){return e.json()})).then((function(e){e.error?alert(e.error):(Object(d.setState)("addMovieForm",{name:"",locations:'"Location"',location:"",bluray:!1,dvd:!1}),g(),alert("Added Movie\nName: "+e.name+"\nLocation: "+e.location+"\nbluray: "+e.bluray+" dvd: "+e.dvd))})).catch((function(e){alert(e)}))}(e)}},r.a.createElement("label",null,"Title"),r.a.createElement("input",{className:"addMovieForm",name:"name",type:"text",value:a.name,onChange:function(e){return v(e.target)},required:!0}),r.a.createElement("label",null,"Location (select existing or enter new)"),r.a.createElement("select",{className:"addMovieForm",name:"locations",value:a.locations,onChange:function(e){return v(e.target)}},r.a.createElement("option",{value:'"Location"'},'"Location"'),n.map((function(e){return r.a.createElement("option",{value:e},e)}))),r.a.createElement("input",{className:"addMovieForm",name:"location",type:"text",value:a.location,onChange:function(e){return v(e.target)},id:"loc"}),r.a.createElement("label",null," Bluray Copy ",r.a.createElement("input",{type:"checkbox",checked:a.bluray,className:"addMovieForm",onChange:function(e){return E(e.target)},name:"bluray"})," "),r.a.createElement("label",null," DVD Copy ",r.a.createElement("input",{type:"checkbox",checked:a.dvd,className:"addMovieForm",onChange:function(e){return E(e.target)},name:"dvd"})," "),r.a.createElement("input",{className:"movieBtn",type:"submit",value:"Save"}))))}}]),n}(k),F=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"filterState",value:function(e){return{registerForm:e.registerForm}}},{key:"render",value:function(){var e=this.props.user,t=this.state.registerForm;return r.a.createElement("div",null,r.a.createElement(S,{user:e}),r.a.createElement("section",{className:"content"},r.a.createElement("header",null,r.a.createElement("h1",null,"Register")),r.a.createElement("form",{onSubmit:function(e){return function(e){e.preventDefault(),console.log("try register");var t=new Request("/auth/register",{method:"post",body:JSON.stringify(Object(d.getState)("registerForm")),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});Object(d.setState)("registerForm.password",""),fetch(t).then((function(e){return e.json()})).then((function(e){e.error&&alert(e.error)})).catch((function(e){alert("something went wrong :(")}))}(e)}},r.a.createElement("label",null,"Username"),r.a.createElement("input",{name:"name",className:"registerForm",value:t.name,onChange:function(e){return v(e.target)},required:!0}),r.a.createElement("label",null,"Password"),r.a.createElement("input",{type:"password",name:"password",className:"registerForm",value:t.password,onChange:function(e){return v(e.target)},required:!0}),r.a.createElement("input",{type:"submit",value:"Register",className:"movieBtn"}))))}}]),n}(k),L=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var a;return Object(l.a)(this,n),a=t.call(this,e),y(),a}return Object(i.a)(n,[{key:"filterState",value:function(e){return{floor:e.floor,source:e.source,planLoad:e.planLoad}}}]),Object(i.a)(n,[{key:"render",value:function(){var e=this.state,t=e.floor,n=e.source,a=e.planLoad,o=this.props.user;return r.a.createElement("div",null,r.a.createElement(S,{user:o}),r.a.createElement("section",{className:"content"},r.a.createElement("header",null,r.a.createElement("h1",null,"Floor Plan")),r.a.createElement("form",{method:"post",encType:"multipart/form-data",onSubmit:function(e){return function(e){e.preventDefault();var t=new FormData;t.append("file",Object(d.getState)("selectedFile")),fetch("/floor",{method:"POST",body:t}).then((function(e){return e.json()})).then((function(e){e.error?alert(e.error):(Object(d.setState)("floor",e.floor),y())})).catch((function(e){alert(e)}))}(e)}},r.a.createElement("input",{className:"fileInpt",type:"file",name:"file",onChange:O}),r.a.createElement("input",{className:"fileInpt",type:"submit",value:"Upload Floor Plan Image"})),a&&t&&r.a.createElement("img",{src:n,alt:"Floor Plan"})))}}]),n}(k),C=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"filterState",value:function(e){return{loginForm:e.loginForm}}},{key:"render",value:function(){var e=this.props.user,t=this.state.loginForm;return r.a.createElement("div",null,r.a.createElement(S,{user:e}),r.a.createElement("section",{className:"content"},r.a.createElement("header",null,r.a.createElement("h1",null,"Login")),r.a.createElement("form",{onSubmit:function(e){return function(e){e.preventDefault();var t=new Request("/auth/login",{method:"post",body:JSON.stringify(Object(d.getState)("loginForm")),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});Object(d.setState)("loginForm.password",""),fetch(t).then((function(e){return e.json()})).then((function(e){e.currentUser?(Object(d.setState)("currentUser",e.currentUser),Object(d.setState)("floor",e.floor)):alert(e.error)})).catch((function(e){alert("something went wrong :(")}))}(e)}},r.a.createElement("label",null,"Username"),r.a.createElement("input",{name:"name",className:"loginForm",value:t.name,onChange:function(e){return v(e.target)},required:!0}),r.a.createElement("label",null,"Password"),r.a.createElement("input",{type:"password",name:"password",className:"loginForm",value:t.password,onChange:function(e){return v(e.target)},required:!0}),r.a.createElement("input",{type:"submit",value:"Login",className:"movieBtn"}))))}}]),n}(k),M=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.movie;return r.a.createElement("li",{className:"movieList"},r.a.createElement("article",{className:"post"},e.imdbInfo&&r.a.createElement("div",{className:"imdb"},"Year: ",e.Year," ",r.a.createElement("br",null),"Runtime: ",e.Runtime," ",r.a.createElement("br",null),"IMDb Raiting: ",e.imdbRating," ",r.a.createElement("br",null),"Genre: ",e.Genre," ",r.a.createElement("br",null),"Director: ",e.Director," ",r.a.createElement("br",null),"Actors: ",e.Actors),r.a.createElement("header",null,r.a.createElement("div",null,r.a.createElement("h1",null," ",e.name," "),r.a.createElement("div",{className:"about"}," at ",e.location," "))),r.a.createElement("p",{className:"body"},e.bluray&&"Bluray Copy",e.bluray&&e.dvd&&r.a.createElement("br",null),e.dvd&&"DVD Copy"),r.a.createElement("button",{className:"movieBtn",onClick:function(t){return function(e){if("yes"===prompt("Are you sure (type yes)","")){var t=new Request("/movies/"+e,{method:"delete",body:JSON.stringify({}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});fetch(t).then((function(e){return e.json()})).then((function(t){if(t.error)alert(t.error);else{var n=Object(d.getState)("movieList");Object(d.setState)("movieList",n.filter((function(t){return t._id!==e})))}})).catch((function(e){alert(e)}))}}(e._id)}}," Delete "),r.a.createElement("button",{className:"movieBtn",onClick:function(t){return n=e._id,a=e.name,void fetch("/imdb/"+a).then((function(e){return console.log("ret json"),e.json()})).then((function(e){console.log(e);var t=Object(d.getState)("movieList").map((function(t){return t._id!==n?t:{_id:t._id,name:t.name,location:t.location,bluray:t.bluray,dvd:t.dvd,imdbInfo:!0,Year:e.Year,Runtime:e.Runtime,Genre:e.Genre,Director:e.Director,Actors:e.Actors,imdbRating:e.imdbRating}}));Object(d.setState)("movieList",t),console.log("exit imdb")})).catch((function(e){alert(e)}));var n,a}}," IMDB "),r.a.createElement("hr",null)))}}]),n}(r.a.Component),x=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var a;return Object(l.a)(this,n),a=t.call(this,e),function(){console.log("get movies");fetch("/movies").then((function(e){return 200===e.status?e.json():Promise.reject("server error")})).then((function(e){var t=e.map((function(e){return e.imdbInfo=!1,e}));console.log(t),Object(d.setState)("movieList",t)})).catch((function(e){alert(e)}))}(),a}return Object(i.a)(n,[{key:"filterState",value:function(e){return{movieList:e.movieList}}}]),Object(i.a)(n,[{key:"render",value:function(){var e=this.state.movieList,t=this.props.user;return r.a.createElement("div",null,r.a.createElement(S,{user:t}),r.a.createElement("section",{className:"content"},r.a.createElement("header",null,r.a.createElement("h1",null,"Movies"),r.a.createElement(m.b,{to:"/add-movie",className:"action"}," Add New Movie ")),r.a.createElement("ul",{className:"movieList"},e.map((function(e){return r.a.createElement(M,{key:e._id,movie:e})})))))}}]),n}(k),D=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var a;return Object(l.a)(this,n),a=t.call(this,e),fetch("/auth/check-session").then((function(e){return 200===e.status?e.json():Promise.resolve({})})).then((function(e){e&&e.currentUser&&(Object(d.setState)("currentUser",e.currentUser),Object(d.setState)("floor",e.floor)),Object(d.setState)("cookie",!0)})).catch((function(e){alert(e)})),a}return Object(i.a)(n,[{key:"filterState",value:function(e){return{currentUser:e.currentUser,cookie:e.cookie}}}]),Object(i.a)(n,[{key:"render",value:function(){var e=this.state,t=e.currentUser;return!1===e.cookie?r.a.createElement("section",{className:"content"}," ",r.a.createElement("header",null," ",r.a.createElement("h1",null," Loading ")," ")," "):r.a.createElement(m.a,null,r.a.createElement(f.d,null," ",r.a.createElement(f.b,{exact:!0,path:"/floor",render:function(e){var n=e.history;return t?r.a.createElement(L,{history:n,user:t}):r.a.createElement(f.a,{to:"/"})}}),r.a.createElement(f.b,{exact:!0,path:"/add-movie",render:function(e){var n=e.history;return t?r.a.createElement(w,{history:n,user:t}):r.a.createElement(f.a,{to:"/"})}}),r.a.createElement(f.b,{exact:!0,path:"/register",render:function(e){var n=e.history;return t?r.a.createElement(f.a,{to:"/"}):r.a.createElement(F,{history:n})}}),r.a.createElement(f.b,{exact:!0,path:"/login",render:function(e){var n=e.history;return t?r.a.createElement(f.a,{to:"/"}):r.a.createElement(C,{history:n})}}),r.a.createElement(f.b,{exact:!0,path:"/",render:function(e){var n=e.history;return t?r.a.createElement(x,{history:n,user:t}):r.a.createElement(f.a,{to:"/login"})}}),r.a.createElement(f.b,{render:function(){return r.a.createElement("section",{className:"content"}," ",r.a.createElement("header",null," ",r.a.createElement("h1",null," 404 Not found ")," ")," ")}})))}}]),n}(k);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));p(),Object(d.startLogging)(),c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(D,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[34,1,2]]]);
//# sourceMappingURL=main.c92b2b71.chunk.js.map